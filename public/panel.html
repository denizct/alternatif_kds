<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alternatif KDS - Y√∂netim Paneli</title>
    <link rel="stylesheet" href="style.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
</head>

<body class="dashboard-page">
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div style="margin-bottom: 20px;">
                <h2 style="margin-bottom: 0;">ALTERNATƒ∞F KDS</h2>
                <small style="color: grey;">v2.0 Executive</small>
            </div>

            <!-- Moved Welcome Message -->
            <!-- User Info (Styled in CSS) -->
            <div class="sidebar-user-info">
                <div>Merhaba,</div>
                <div id="welcomeUser">Y√∂netici</div>
            </div>

            <nav>
                <a href="#" class="menu-item active" onclick="switchView('view-executive', this)">üìä Dashboard</a>
                <a href="#" class="menu-item" onclick="switchView('view-strategic', this)">‚ö° Stratejik Planlama</a>
            </nav>
            <button onclick="logout()" class="logout-btn"><i class="fas fa-sign-out-alt"></i> √áIKI≈û YAP</button>
        </aside>

        <!-- Main Content -->
        <main class="main-content">

            <!-- Global Filters -->
            <div class="filter-bar">
                <div class="filter-group">
                    <label>D√∂nem Se√ßimi</label>
                    <select id="periodFilter" onchange="updateDashboard()">
                        <option value="12" selected>Son 12 Ay</option>
                        <option value="6">Son 6 Ay</option>
                        <option value="2025">2025</option>
                        <option value="2024">2024</option>
                        <option value="all">T√ºm Zamanlar</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label>≈ûehir</label>
                    <select id="cityFilter" onchange="updateDashboard()"> <!-- Trigger update directly -->
                        <option value="all">T√ºm ≈ûehirler</option>
                    </select>
                </div>

                <!-- Custom Date Range -->
                <div class="filter-group">
                    <label>√ñzel Tarih Aralƒ±ƒüƒ±</label>
                    <div style="display: flex; gap: 5px;">
                        <input type="date" id="startDate" class="date-input">
                        <span style="align-self: center;">-</span>
                        <input type="date" id="endDate" class="date-input">
                    </div>
                </div>

                <div class="filter-group">
                    <button onclick="updateDashboard()">Filtrele</button>
                </div>
            </div>

            <!-- VIEW 1: EXECUTIVE DASHBOARD (Combined) -->
            <div id="view-executive" class="view-section executive-grid">

                <!-- 1. KPI Cards -->
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <i class="fas fa-wallet kpi-icon"></i>
                        <div class="stat-title">Toplam Ciro</div>
                        <div class="stat-value" id="totalRevenue">-</div>
                        <div class="stat-trend" id="revenuePeriodLabel">Se√ßili D√∂nem</div>
                    </div>
                    <div class="kpi-card">
                        <i class="fas fa-shopping-basket kpi-icon"></i>
                        <div class="stat-title">Toplam Satƒ±≈ü Adedi</div>
                        <div class="stat-value" id="totalSalesCount">-</div>
                    </div>
                    <div class="kpi-card">
                        <i class="fas fa-store kpi-icon"></i>
                        <div class="stat-title">En Ba≈üarƒ±lƒ± ≈ûube</div>
                        <div class="stat-value" id="bestBranch" style="font-size: 20px;">-</div>
                    </div>
                    <div class="kpi-card" style="border-bottom: 2px solid var(--danger-color);">
                        <i class="fas fa-exclamation-triangle kpi-icon"
                            style="color:var(--danger-color); opacity:1;"></i>
                        <div class="stat-title">Kritik Kategori Uyarƒ±sƒ±</div>
                        <div class="stat-value" id="criticalStock" style="font-size: 18px; color:var(--danger-color);">-
                        </div>
                        <div class="stat-trend" style="background:rgba(239, 68, 68, 0.1); color:var(--danger-color);">
                            Stok Kontrol√º √ñnerilir</div>
                    </div>
                </div>

                <!-- 2. Charts Split Grid (Fills remaining height) -->
                <div class="charts-split-grid">

                    <!-- Top: Trend Chart -->
                    <div class="trend-section dashboard-card">
                        <h3><i class="fas fa-chart-line"></i> Satƒ±≈ü Trendi</h3>
                        <div class="chart-wrapper">
                            <canvas id="trendChart"></canvas>
                        </div>
                    </div>

                    <!-- Bottom: Details Grid -->
                    <div class="details-section">
                        <div class="dashboard-card">
                            <h3>Kategori Daƒüƒ±lƒ±mƒ±</h3>
                            <div class="chart-wrapper">
                                <canvas id="categoryChart"></canvas>
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <h3>Market Ciro Sƒ±ralamasƒ±</h3>
                            <div class="chart-wrapper">
                                <canvas id="marketChart"></canvas>
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <h3>En √áok Satan 5 √úr√ºn</h3>
                            <div class="table-wrapper">
                                <table style="width:100%; border-collapse: collapse;">
                                    <tbody id="topProductsBody">
                                        <!-- JS Fill -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- VIEW 2: STRATEGIC PLANNING (Existing, slightly styled container) -->
            <div id="view-strategic" class="view-section" style="display:none;">
                <div style="margin-bottom:20px;">
                    <h2 style="margin:0;">Stratejik Planlama & B√ºy√ºme</h2>
                </div>

                <div class="card"
                    style="margin-bottom:24px; padding:20px; background:var(--card-bg); border-radius:16px;">
                    <h3 style="margin-bottom:20px; text-transform:uppercase; font-size:14px; color:#aaa;">Trend Analizi
                    </h3>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                        <div
                            style="background:rgba(0, 255, 157, 0.05); padding:15px; border-radius:12px; border-left:4px solid var(--success-color);">
                            <h4 style="color:var(--success-color); margin-top:0;">üöÄ Y√ºkselen Trendler</h4>
                            <div id="trendRisingList">Veriler y√ºkleniyor...</div>
                        </div>
                        <div
                            style="background:rgba(255, 0, 85, 0.05); padding:15px; border-radius:12px; border-left:4px solid var(--danger-color);">
                            <h4 style="color:var(--danger-color); margin-top:0;">üìâ D√º≈ü√º≈ü G√∂sterenler</h4>
                            <div id="trendFallingList">Veriler y√ºkleniyor...</div>
                        </div>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-container">
                        <h3>üìä ≈ûube Performans Matrisi</h3>
                        <div style="overflow-x:auto; max-height: 400px;">
                            <table style="width:100%; text-align:left; border-collapse: collapse;">
                                <thead style="background:#1e293b; position:sticky; top:0;">
                                    <tr>
                                        <th style="padding:10px;">≈ûube</th>
                                        <th style="padding:10px;">Vrm. Skoru</th>
                                        <th style="padding:10px;">Durum</th>
                                    </tr>
                                </thead>
                                <tbody id="branchPerformanceBody"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="chart-container">
                        <h3>üìç Lokasyon Fƒ±rsat Analizi</h3>
                        <div id="locationOpportunities"
                            style="display:flex; flex-direction:column; gap:10px; max-height:400px; overflow-y:auto;">
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script src="script.js?v=2"></script>
</body>

</html>